import numpy as np
import os
import sys

path_to_utils = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(path_to_utils)
from utils import convert_pt_to_polytope, visualize_results

s = np.array([-11.581207491093068, -13.856678080453468])

t = np.array([13, -1.39])

A_s, b_s = convert_pt_to_polytope(s, eps=1e-6)
A_t, b_t = convert_pt_to_polytope(t, eps=1e-6)

A0 = np.array([[-0.9191450300180579, -0.3939192985791677], [-0.5144957554275266, 0.8574929257125442], [0.5999999999999996, 0.8000000000000003], [0.9191450300180578, -0.3939192985791681], [-0.0, -1.0]])

b0 = np.array([-3.90552466967377, -8.267111283792707, 5.025641025641046, 16.83415805893882, 12.820512820512848])

A1 = np.array([[-0.9284766908852594, -0.3713906763541037], [0.0, -1.0], [0.0, 1.0], [0.928476690885259, 0.37139067635410483]])

b1 = np.array([-6.380301363006361, 20.000000000000036, -14.871794871794838, 7.332585148529747])

A2 = np.array([[-0.242535625036333, 0.970142500145332], [-0.8574929257125442, -0.5144957554275266], [-0.4472135954999579, -0.8944271909999159], [1.0, -0.0], [0.970142500145332, 0.242535625036333]])

b2 = np.array([3.3581855774261573, -2.2866478019001053, -0.22934030538458183, 5.6410256410256485, 5.596975962376922])

A3 = np.array([[0.242535625036333, -0.970142500145332], [-0.9805806756909202, 0.19611613513818404], [0.3939192985791677, 0.9191450300180579]])

b3 = np.array([20.024736220948554, -6.436632127612158, -12.255267066907406])

A4 = np.array([[-0.4472135954999583, 0.8944271909999156], [-0.0, 1.0], [-0.0, -1.0], [0.7071067811865475, -0.7071067811865475]])

b4 = np.array([10.320313742306745, 20.000000000000036, -16.923076923076884, 3.425447832933106e-14])

A5 = np.array([[-0.9486832980505138, -0.31622776601683794], [0.5144957554275266, -0.8574929257125442], [0.7071067811865476, 0.7071067811865476], [0.0, 1.0], [0.3713906763541037, 0.9284766908852594]])

b5 = np.array([4.540706383831537, 7.563527344746559, -2.1757131728816703, -3.5897435897435748, -4.285277034855029])

A6 = np.array([[-1.0, 0.0], [0.970142500145332, 0.242535625036333], [-0.9805806756909202, -0.19611613513818404], [1.0, -0.0]])

b6 = np.array([20.000000000000032, -19.527227246514986, 20.11447539878814, -18.974358974358942])

A7 = np.array([[-0.7071067811865476, -0.7071067811865476], [0.8944271909999159, -0.4472135954999579], [-0.3713906763541037, 0.9284766908852594], [-0.0, 1.0]])

b7 = np.array([5.801901794351189, -12.155036185383445, 13.046287861669823, 9.743589743589768])

A8 = np.array([[-0.9701425001453318, -0.24253562503633314], [0.7071067811865479, -0.7071067811865471], [-0.8320502943378439, 0.5547001962252287], [0.7071067811865476, 0.7071067811865476], [0.0, 1.0]])

b8 = np.array([-13.805874040529691, 1.4504754485878295, -1.2800773759043547, 23.932844901698562, 16.92307692307695])

A9 = np.array([[-0.242535625036333, 0.970142500145332], [0.8944271909999159, 0.4472135954999579], [-1.0, -0.0], [-0.1414213562373095, -0.9899494936611666]])

b9 = np.array([9.57704775784496, 8.026910688460799, 0.512820512820533, -5.51180670463358])

A10 = np.array([[-0.970142500145332, -0.242535625036333], [-0.4472135954999579, 0.8944271909999159], [-0.0, 1.0], [0.8320502943378437, -0.5547001962252291], [0.7071067811865476, -0.7071067811865476]])

b10 = np.array([13.557119553313, 9.861633131537557, 4.615384615384637, -10.667311465869766, -9.42809041582061])

A11 = np.array([[-0.9486832980505139, -0.31622776601683755], [-0.16439898730535674, -0.9863939238321437], [0.0, 1.0], [0.8, 0.6]])

b11 = np.array([7.784068086568363, -14.416526579085147, 20.000000000000036, 3.3846153846154174])

A12 = np.array([[0.31622776601683794, -0.9486832980505138], [0.0, 1.0], [0.0, -1.0], [1.0, -0.0], [0.9486832980505138, 0.31622776601683794], [-1.0, -0.0], [-0.9805806756909202, -0.19611613513818404]])

b12 = np.array([14.919463832589305, -10.769230769230742, 16.92307692307695, -0.5128205128204856, -4.865042554105171, 7.692307692307723, 9.856092945406202])

A13 = np.array([[0.7808688094430304, -0.6246950475544243], [-0.0, 1.0], [-1.0, 0.0], [-0.7071067811865476, 0.7071067811865476]])

b13 = np.array([-18.020049448685285, 12.820512820512846, 16.92307692307695, 20.306656280229085])

A14 = np.array([[-0.242535625036333, 0.970142500145332], [0.9486832980505138, 0.31622776601683794], [0.31622776601683794, 0.9486832980505138], [-0.7071067811865476, -0.7071067811865476], [0.0, -1.0], [-0.242535625036333, -0.970142500145332]])

b14 = np.array([-1.6169041669088533, -14.270791492041884, -10.378757448757726, 18.856180831641304, 9.743589743589778, 12.810856091662751])

A15 = np.array([[-0.9899494936611666, -0.1414213562373095], [0.8, -0.6], [-0.6, 0.8], [0.5547001962252291, 0.8320502943378437]])

b15 = np.array([19.14627592135886, -13.641025641025607, 15.692307692307724, -2.417923932263789])

A16 = np.array([[0.6, -0.8], [0.0, 1.0], [0.6246950475544243, 0.7808688094430304], [-0.9191450300180579, -0.3939192985791677], [0.0, -1.0]])

b16 = np.array([0.10256410256412504, 12.820512820512839, 14.1757722329658, -8.349742397233616, -5.6410256410256165])

A17 = np.array([[0.8320502943378437, 0.5547001962252291], [-0.5547001962252291, -0.8320502943378437], [-0.8944271909999159, 0.4472135954999579], [-0.0, 1.0], [0.7071067811865476, -0.7071067811865476], [0.5547001962252291, -0.8320502943378437]])

b17 = np.array([-6.400386879521847, 16.925467525846766, -4.816146413076439, -13.846153846153817, 14.504754485877926, 16.356544247667042])

A18 = np.array([[-0.7071067811865474, -0.7071067811865478], [-1.0, 0.0], [0.9284766908852592, 0.37139067635410394], [0.3162277660168389, 0.9486832980505133]])

b18 = np.array([-10.1533281401145, 3.58974358974362, 6.189844605901757, 16.865480854231368])

A19 = np.array([[-0.9486832980505138, 0.31622776601683794], [-0.8, -0.6], [0.0, -1.0], [1.0, 0.0], [0.8320502943378428, -0.5547001962252305], [0.242535625036333, 0.970142500145332], [0.0, 1.0]])

b19 = np.array([-13.946455321768202, -4.205128205128169, 12.820512820512855, 20.000000000000036, 22.04577702946427, -1.6169041669088533, -5.641025641025608])

A20 = np.array([[-0.9486832980505135, 0.3162277660168382], [0.16439898730535674, 0.9863939238321437], [0.16439898730535785, -0.9863939238321436], [0.7071067811865464, -0.7071067811865488]])

b20 = np.array([22.703531919157626, 14.753755270993636, -17.788813498169404, -20.30665628022903])

A21 = np.array([[-0.6, 0.8], [-0.7071067811865476, -0.7071067811865476], [-0.6, -0.8], [0.8944271909999159, -0.4472135954999579], [-0.0, -1.0], [0.7071067811865476, 0.7071067811865476], [0.242535625036333, 0.970142500145332]])

b21 = np.array([-9.94871794871792, 9.428090415820666, 10.7692307692308, 14.448439239229437, 16.92307692307695, -2.1757131728816588, -8.58202980897791])

A22 = np.array([[-0.7071067811865476, -0.7071067811865476], [1.0, 0.0], [-0.0, -1.0], [-1.0, 0.0], [-0.21693045781865616, 0.9761870601839527]])

b22 = np.array([3.6261886214694954, -1.5384615384615217, -1.5384615384615181, 10.769230769230788, 8.844087895683689])

A23 = np.array([[-0.7071067811865476, -0.7071067811865476], [-0.49613893835683404, 0.8682431421244592], [0.8944271909999153, 0.4472135954999592], [0.9486832980505133, -0.3162277660168389], [0.7071067811865479, -0.7071067811865471]])

b23 = np.array([-12.329041312996178, 0.4452528933971896, 20.869967789998064, 15.243800002862969, 8.702852691526777])

A24 = np.array([[-0.9805806756909202, -0.19611613513818404], [-0.8944271909999159, 0.4472135954999579], [0.9486832980505138, -0.31622776601683794], [0.31622776601683794, -0.9486832980505138], [0.8944271909999159, 0.4472135954999579], [0.0, 1.0]])

b24 = np.array([-2.0114475398787897, -3.4401045807688875, 11.027429789305133, 8.432740427115696, 8.485591299229986, -0.5128205128204961])

A25 = np.array([[-0.8944271909999159, 0.4472135954999579], [-0.35112344158839165, -0.9363291775690444], [0.8944271909999159, -0.4472135954999579], [0.6246950475544246, 0.78086880944303], [0.4472135954999567, 0.8944271909999165]])

b25 = np.array([13.531078017691062, -4.381540382214086, -4.816146413076441, 9.530603930638033, 12.155036185383517])

A26 = np.array([[0.24253562503633377, -0.9701425001453318], [0.0, -1.0], [0.16439898730535785, 0.9863939238321436], [0.44721359549995754, 0.8944271909999161], [-0.8320502943378439, -0.5547001962252287], [-0.5547001962252291, -0.8320502943378437]])

b26 = np.array([-12.313347117229167, -14.871794871794835, 19.812185649620016, 19.952606568459696, -11.520696383139331, -15.503159330397391])

A27 = np.array([[0.7071067811865476, 0.7071067811865476], [-1.0, 0.0], [-0.0, 1.0], [0.31622776601683794, -0.9486832980505138], [1.0, 0.0]])

b27 = np.array([-20.306656280229024, 20.000000000000036, -10.769230769230736, 10.703093619031472, -13.846153846153813])

A28 = np.array([[0.9938837346736189, -0.11043152607484655], [-0.9486832980505138, 0.31622776601683794], [-0.1414213562373095, 0.9899494936611666], [-0.7071067811865476, -0.7071067811865476], [-0.31622776601683794, -0.9486832980505138]])

b28 = np.array([-7.588627945656088, 11.67610212985251, -8.41275760180915, 21.75713172881688, 21.081851067789227])

A29 = np.array([[-0.9805806756909201, 0.19611613513818468], [-0.9486832980505133, -0.3162277660168389], [-0.1961161351381839, -0.9805806756909202], [0.9486832980505133, 0.3162277660168389], [0.7071067811865479, 0.7071067811865471]])

b29 = np.array([-13.27555376320011, -13.622119151494514, -1.4080132779151304, 18.162825535326096, 15.229992210171824])

A30 = np.array([[-0.9486832980505138, 0.31622776601683794], [0.242535625036333, 0.970142500145332], [-0.0, -1.0], [0.7071067811865476, -0.7071067811865476]])

b30 = np.array([3.8920340432841734, -5.845730449593655, 7.692307692307707, 2.900950897175593])

A31 = np.array([[-0.9486832980505135, -0.3162277660168382], [0.5547001962252291, -0.8320502943378437], [-1.0, 0.0], [-0.0, 1.0]])

b31 = np.array([13.297782981220902, -22.89916194673378, 20.000000000000036, 18.974358974359006])

A32 = np.array([[-0.4472135954999579, -0.8944271909999159], [0.3713906763541037, -0.9284766908852594], [-1.0, 0.0], [-0.4472135954999579, 0.8944271909999159], [0.8320502943378437, 0.5547001962252291], [0.5547001962252291, 0.8320502943378437]])

b32 = np.array([9.861633131537564, 20.093187874542565, -7.6923076923076605, -13.989758628460194, 5.831463601342178, -1.5645390149942096])

A33 = np.array([[-0.970142500145332, -0.242535625036333], [0.2747211278973782, -0.9615239476408232], [0.9486832980505142, 0.31622776601683694], [-0.8944271909999159, 0.4472135954999579], [0.16439898730535726, 0.9863939238321436]])

b33 = np.array([-9.32829327062816, 7.396338058775593, 16.216808513684025, -8.944271909999129, 3.2879797461071716])

A34 = np.array([[-0.1414213562373095, 0.9899494936611666], [-0.6, -0.8], [1.0, 0.0], [0.5547001962252291, -0.8320502943378437]])

b34 = np.array([-7.687519877515262, 16.102564102564127, -6.666666666666644, 5.2625403231624555])

A35 = np.array([[-0.0, -1.0], [0.9486832980505142, 0.31622776601683694], [0.4472135954999579, 0.8944271909999159], [-0.8944271909999159, 0.4472135954999579], [-0.0, 1.0], [-0.7071067811865476, 0.7071067811865476]])

b35 = np.array([-0.5128205128204882, 13.2977829812209, 8.944271909999179, -5.733507634614821, 4.615384615384636, -3.626188621469452])

A36 = np.array([[0.7071067811865479, -0.7071067811865472], [1.0, 0.0], [-0.9486832980505138, 0.31622776601683794], [-0.5547001962252291, 0.8320502943378437]])

b36 = np.array([-22.482369453110707, -15.897435897435864, 22.70353191915763, 22.89916194673385])

A37 = np.array([[0.6246950475544243, -0.7808688094430304], [0.6246950475544243, 0.7808688094430304], [-0.8320502943378437, -0.5547001962252291], [-0.7071067811865476, -0.7071067811865476], [-1.0, 0.0], [-0.31622776601683794, 0.9486832980505138]])

b37 = np.array([0.24026732598248726, -2.1624059338422237, 8.960541631330642, 8.702852691526758, 9.74358974358976, 4.540706383831535])

A38 = np.array([[0.3162277660168389, 0.9486832980505133], [0.9486832980505138, 0.31622776601683794], [-0.9486832980505139, -0.31622776601683755], [-0.31622776601683794, -0.9486832980505138]])

b38 = np.array([15.243800002862976, 8.10840425684202, -5.513714894652526, -12.64911064067349])

A39 = np.array([[0.4472135954999579, 0.8944271909999159], [-0.9863939238321436, 0.16439898730535726], [-0.4472135954999579, 0.8944271909999159], [0.7071067811865475, -0.7071067811865475], [0.8320502943378437, -0.5547001962252291]])

b39 = np.array([-4.816146413076444, 15.765441346718905, 7.568230077691622, -7.977614967232816, -10.098388187690041])

As = {
    "s": A_s,
    "t": A_t,
    0: A0,
    1: A1,
    2: A2,
    3: A3,
    4: A4,
    5: A5,
    6: A6,
    7: A7,
    8: A8,
    9: A9,
    10: A10,
    11: A11,
    12: A12,
    13: A13,
    14: A14,
    15: A15,
    16: A16,
    17: A17,
    18: A18,
    19: A19,
    20: A20,
    21: A21,
    22: A22,
    23: A23,
    24: A24,
    25: A25,
    26: A26,
    27: A27,
    28: A28,
    29: A29,
    30: A30,
    31: A31,
    32: A32,
    33: A33,
    34: A34,
    35: A35,
    36: A36,
    37: A37,
    38: A38,
    39: A39,
}

bs = {
    "s": b_s,
    "t": b_t,
    0: b0,
    1: b1,
    2: b2,
    3: b3,
    4: b4,
    5: b5,
    6: b6,
    7: b7,
    8: b8,
    9: b9,
    10: b10,
    11: b11,
    12: b12,
    13: b13,
    14: b14,
    15: b15,
    16: b16,
    17: b17,
    18: b18,
    19: b19,
    20: b20,
    21: b21,
    22: b22,
    23: b23,
    24: b24,
    25: b25,
    26: b26,
    27: b27,
    28: b28,
    29: b29,
    30: b30,
    31: b31,
    32: b32,
    33: b33,
    34: b34,
    35: b35,
    36: b36,
    37: b37,
    38: b38,
    39: b39,
}

n = A0.shape[1]
# For rounding step: 
N = 8
M = 16

# If file is run directly, visualize the GCS
if __name__ == "__main__":
   visualize_results(As, bs, {**{i: 0 for i in range(len(As)-2)}, **{"s": np.hstack([s,s]), "t": np.hstack([t,t])}}, {**{i: 0 for i in range(len(As)-2)}, **{"s": 1, "t": 1}})