import numpy as np
import os
import sys

path_to_utils = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(path_to_utils)
from utils import convert_pt_to_polytope, visualize_results

s = np.array([-32.27046081524402, 36.786022137384734])

t = np.array([26.089186881852257, -53.16715304698663])

A_s, b_s = convert_pt_to_polytope(s, eps=1e-6)
A_t, b_t = convert_pt_to_polytope(t, eps=1e-6)

A0 = np.array([[-0.9701425001453318, -0.24253562503633308], [0.1643989873053571, -0.9863939238321437], [-0.242535625036333, 0.970142500145332], [0.7999999999999998, 0.6000000000000001]])

b0 = np.array([1.5053935347083536, 48.63942451999889, -31.613264228873668, 2.068965517241459])

A1 = np.array([[-0.7071067811865477, -0.7071067811865474], [1.0, 0.0], [-1.0, 0.0], [-0.24253562503633314, 0.9701425001453318]])

b1 = np.array([5.851918189130083, -6.206896551724096, 22.758620689655206, 23.584498710429656])

A2 = np.array([[-0.9486832980505138, -0.3162277660168381], [-0.9701425001453318, 0.24253562503633305], [1.0, 0.0]])

b2 = np.array([-47.10703273078405, -51.68517802498397, 55.862068965517345])

A3 = np.array([[-0.0, -1.0], [0.9863939238321437, -0.1643989873053571], [-0.961523947640823, 0.27472112789737807], [0.24253562503633314, 0.9701425001453318]])

b3 = np.array([51.72413793103457, -1.7006791790208526, 15.630684863126763, -27.598881469651587])

A4 = np.array([[-0.099503719020999, -0.995037190209989], [-0.8, 0.6000000000000002], [0.7071067811865478, 0.7071067811865474], [0.4472135954999579, 0.8944271909999159]])

b4 = np.array([57.84940354117395, -15.31034482758612, -29.259590945650128, -39.786588841030635])

A5 = np.array([[-0.24253562503633277, 0.970142500145332], [0.8944271909999159, 0.4472135954999583], [-0.5547001962252288, -0.8320502943378438], [0.7071067811865469, -0.7071067811865481], [-0.0, -1.0]])

b5 = np.array([-2.508989224513745, 17.58012065068804, 0.5738277891985478, 20.481713661955197, 10.344827586206929])

A6 = np.array([[-0.9284766908852593, 0.37139067635410367], [0.44721359549995815, 0.8944271909999159], [-0.4472135954999583, -0.8944271909999159], [0.7071067811865474, -0.7071067811865477]])

b6 = np.array([44.182683911091736, 34.23497179344514, -12.028503603102223, -38.03746822934523])

A7 = np.array([[-0.5547001962252289, -0.8320502943378438], [0.7071067811865469, -0.7071067811865481], [-0.3162277660168383, 0.9486832980505137], [0.4472135954999579, 0.8944271909999159]])

b7 = np.array([-18.936317043550883, 5.851918189130071, 15.70234424359475, 28.68335474585942])

A8 = np.array([[-0.24253562503633236, -0.970142500145332], [-0.44721359549995854, 0.8944271909999155], [0.7071067811865469, 0.7071067811865481]])

b8 = np.array([-50.68158233517845, 23.13173769827373, 64.37110008043062])

A9 = np.array([[-0.0, -1.0], [-0.4472135954999579, 0.8944271909999159], [0.7071067811865472, 0.7071067811865479], [0.0, 1.0]])

b9 = np.array([35.17241379310354, -6.476886555516533, -52.66726370217034, -31.03448275862059])

A10 = np.array([[-0.9486832980505139, 0.3162277660168379], [-0.0, 1.0], [0.7071067811865469, -0.7071067811865481], [0.9284766908852593, -0.3713906763541037]])

b10 = np.array([26.170573739324585, 39.310344827586285, -26.333631851085148, -24.20442683825014])

A11 = np.array([[-0.9899494936611666, -0.14142135623730961], [0.9899494936611666, -0.14142135623730961], [-0.7071067811865476, 0.7071067811865476], [0.7071067811865476, 0.7071067811865476]])

b11 = np.array([-50.32649642651834, 52.082071883257534, -17.555754567390057, 55.59322279673557])

A12 = np.array([[-0.7071067811865481, 0.7071067811865469], [0.8320502943378436, 0.5547001962252293], [-0.7071067811865472, -0.7071067811865478], [0.0, -1.0]])

b12 = np.array([73.14897736412571, -14.345694729962709, 5.851918189130107, -39.31034482758613])

A13 = np.array([[-0.8944271909999159, -0.4472135954999581], [0.8944271909999159, -0.4472135954999579], [0.3162277660168376, -0.948683298050514], [0.3162277660168376, 0.948683298050514], [0.7071067811865476, 0.7071067811865476]])

b13 = np.array([24.982276714135644, -13.879042618964142, -6.542643434831057, 9.159700808763667, 7.798590878715565e-14])

A14 = np.array([[-0.19611613513818396, -0.9805806756909201], [-0.7071067811865476, 0.7071067811865476], [1.0, -0.0], [0.447213595499958, 0.894427190999916]])

b14 = np.array([59.240598062430855, -5.851918189129943, -2.068965517241271, -43.48766687275443])

A15 = np.array([[-0.19611613513818416, -0.9805806756909201], [0.8944271909999159, 0.4472135954999579], [-0.3162277660168383, 0.9486832980505137], [-0.0, 1.0]])

b15 = np.array([7.303635377560037, 41.63712785689274, -24.862045052358212, -10.344827586206797])

A16 = np.array([[0.64018439966448, -0.7682212795973757], [-0.3162277660168376, 0.948683298050514], [0.5144957554275266, 0.8574929257125441], [-1.0, -0.0], [-0.7071067811865475, -0.7071067811865475]])

b16 = np.array([35.76202508470551, -17.010872930560858, -17.031583627945615, 14.482758620689737, 40.96342732391042])

A17 = np.array([[-0.9486832980505138, -0.3162277660168381], [0.3162277660168383, -0.9486832980505137], [0.0, 1.0], [0.7071067811865478, 0.7071067811865472]])

b17 = np.array([-14.393815556628383, 68.04349172224386, -47.58620689655162, -5.851918189129908])

A18 = np.array([[-0.8944271909999159, 0.4472135954999579], [0.7682212795973759, 0.6401843996644798], [-0.3713906763541034, -0.9284766908852594], [0.0, -1.0]])

b18 = np.array([-12.02850360310223, 46.35818066535899, -25.7412158438533, -10.344827586206815])

A19 = np.array([[-0.8320502943378438, 0.5547001962252289], [1.0, 0.0], [-1.0, -0.0], [-0.44721359549995854, -0.8944271909999155]])

b19 = np.array([-25.822250513932993, 60.0000000000001, -51.72413793103439, -43.48766687275446])

A20 = np.array([[0.44721359549995815, 0.8944271909999159], [0.9486832980505137, -0.3162277660168383], [-0.9805806756909201, -0.19611613513818416], [0.0, -1.0]])

b20 = np.array([-2.7758085237927945, -10.468229495729755, 24.34545125853323, 10.344827586206936])

A21 = np.array([[-1.0, 0.0], [-0.8320502943378436, -0.5547001962252291], [0.7071067811865474, -0.7071067811865476], [0.8320502943378438, 0.554700196225229], [0.3162277660168381, 0.9486832980505138]])

b21 = np.array([22.75862068965522, 29.265217249124206, 11.703836378260155, -12.050383573168713, -9.159700808763525])

A22 = np.array([[-0.9922778767136675, -0.12403473458920834], [0.14142135623730945, -0.9899494936611666], [-0.4472135954999583, 0.8944271909999159], [0.4472135954999579, 0.8944271909999159], [0.8944271909999159, 0.44721359549995815], [0.8320502943378438, 0.5547001962252289]])

b22 = np.array([1.7963651216368601, 31.01516640238931, 2.7758085237928953, 8.327425571378587, 15.729581634826163, 13.198039151565858])

A23 = np.array([[-0.8944271909999157, -0.44721359549995804], [0.44721359549995815, -0.8944271909999159], [1.0, -0.0], [0.0, 1.0], [0.44721359549995815, 0.8944271909999159]])

b23 = np.array([34.23497179344512, -0.9252695079308848, -22.758620689655096, 10.344827586206975, -4.626347539654665])

A24 = np.array([[-0.19611613513818413, -0.9805806756909201], [0.8944271909999159, -0.4472135954999579], [-0.7071067811865475, 0.7071067811865475], [-0.1961161351381841, 0.9805806756909201]])

b24 = np.array([32.460601678044334, -15.729581634826015, 20.48171366195526, -5.680605293657647])

A25 = np.array([[-0.8944271909999159, -0.4472135954999583], [0.8944271909999159, -0.4472135954999583], [-0.7071067811865472, 0.7071067811865479], [1.0, -0.0]])

b25 = np.array([6.4768865555167565, 47.18874490447844, -49.74130460760533, 26.89655172413804])

A26 = np.array([[-0.9701425001453318, 0.24253562503633305], [0.7071067811865476, 0.7071067811865474], [-0.7071067811865472, -0.7071067811865479], [0.7071067811865469, -0.7071067811865481], [-0.0, -1.0]])

b26 = np.array([-26.595285779846087, 32.18555004021536, -17.555754567390064, 40.9634273239104, 10.344827586206971])

A27 = np.array([[-0.5547001962252287, 0.8320502943378439], [-0.8320502943378436, -0.5547001962252293], [0.9805806756909201, -0.1961161351381843]])

b27 = np.array([44.1847397682856, -26.96990609233003, -1.6230300839021323])

A28 = np.array([[0.7071067811865475, -0.7071067811865475], [-0.8944271909999162, 0.44721359549995754], [-0.44721359549995765, 0.8944271909999161]])

b28 = np.array([-5.8519181891299645, 24.98227671413569, -8.327425571378459])

A29 = np.array([[0.8574929257125439, 0.514495755427527], [-0.9863939238321437, 0.16439898730535737], [-0.24253562503633236, 0.970142500145332], [0.9486832980505139, -0.31622776601683794], [-0.16439898730535737, -0.9863939238321437], [0.0, -1.0]])

b29 = np.array([53.933348155161525, -1.0204075074124594, 51.68517802498418, 24.862045052358408, -31.632632729789343, -26.896551724137833])

A30 = np.array([[-0.5547001962252287, 0.8320502943378439], [-1.0, -0.0], [0.9863939238321437, 0.16439898730535737], [0.3162277660168381, 0.9486832980505138], [0.24253562503633225, -0.970142500145332], [-0.0, -1.0]])

b30 = np.array([61.39957344424096, 51.72413793103457, -19.387742640838592, 32.71321717415573, -23.58449871042951, -14.482758620689577])

A31 = np.array([[-0.9284766908852593, 0.37139067635410367], [0.9863939238321437, 0.16439898730535737], [0.8944271909999159, -0.4472135954999583], [-1.0, -0.0], [-0.4472135954999576, -0.894427190999916]])

b31 = np.array([59.55057396712363, -45.918337833565204, -45.33820588861632, 60.0000000000001, 24.98227671413566])

A32 = np.array([[-0.5547001962252289, -0.8320502943378438], [-0.7071067811865481, 0.7071067811865469], [0.9701425001453318, 0.24253562503633314]])

b32 = np.array([-61.3995734442408, 5.851918189130085, 59.71394354342829])

A33 = np.array([[0.12403473458920852, -0.9922778767136675], [-0.7071067811865472, 0.7071067811865478], [0.24253562503633236, 0.970142500145332], [0.0, 1.0]])

b33 = np.array([-54.66082441552005, 55.59322279673557, 55.699560784206234, 60.0000000000001])

A34 = np.array([[0.993883734673619, -0.11043152607484624], [-0.970142500145332, 0.24253562503633236], [-0.4472135954999583, 0.8944271909999159], [-0.7071067811865487, -0.7071067811865464], [-0.5547001962252288, -0.8320502943378438]])

b34 = np.array([60.77541917774324, -46.667199575956374, -36.08551080930687, -2.92595909456502, 8.607416837977816])

A35 = np.array([[-0.9284766908852593, 0.37139067635410367], [0.894427190999916, 0.447213595499958], [-1.0, -0.0], [0.19611613513818382, -0.9805806756909201]])

b35 = np.array([50.3298399335045, -43.48766687275443, 60.0000000000001, 10.54969554536449])

A36 = np.array([[-0.7071067811865476, 0.7071067811865476], [-0.970142500145332, -0.242535625036333], [0.3162277660168381, -0.9486832980505138], [1.0, -0.0], [0.4472135954999579, 0.8944271909999159]])

b36 = np.array([35.111509134780384, 5.51977629393042, -20.936458991459524, 14.482758620689753, 52.7403619520641])

A37 = np.array([[-0.9486832980505138, -0.31622776601683805], [-0.31622776601683816, -0.9486832980505137], [0.24253562503633236, 0.970142500145332], [1.0, -0.0]])

b37 = np.array([14.393815556628578, -35.33027454808799, 49.67798664537315, -18.62068965517231])

A38 = np.array([[-0.9486832980505141, -0.3162277660168371], [0.7808688094430302, -0.6246950475544245], [0.8944271909999159, 0.4472135954999579], [-0.8320502943378439, 0.5547001962252287], [-0.4472135954999579, 0.8944271909999159]])

b38 = np.array([-13.08528686966222, 23.587623347313663, 34.234971793445126, -13.198039151565744, -0.9252695079308817])

A39 = np.array([[0.31622776601683766, -0.9486832980505139], [-1.0, 0.0], [0.7999999999999998, 0.6000000000000001]])

b39 = np.array([36.63880323505438, -22.758620689655114, 12.00000000000006])

As = {
    "s": A_s,
    "t": A_t,
    0: A0,
    1: A1,
    2: A2,
    3: A3,
    4: A4,
    5: A5,
    6: A6,
    7: A7,
    8: A8,
    9: A9,
    10: A10,
    11: A11,
    12: A12,
    13: A13,
    14: A14,
    15: A15,
    16: A16,
    17: A17,
    18: A18,
    19: A19,
    20: A20,
    21: A21,
    22: A22,
    23: A23,
    24: A24,
    25: A25,
    26: A26,
    27: A27,
    28: A28,
    29: A29,
    30: A30,
    31: A31,
    32: A32,
    33: A33,
    34: A34,
    35: A35,
    36: A36,
    37: A37,
    38: A38,
    39: A39,
}

bs = {
    "s": b_s,
    "t": b_t,
    0: b0,
    1: b1,
    2: b2,
    3: b3,
    4: b4,
    5: b5,
    6: b6,
    7: b7,
    8: b8,
    9: b9,
    10: b10,
    11: b11,
    12: b12,
    13: b13,
    14: b14,
    15: b15,
    16: b16,
    17: b17,
    18: b18,
    19: b19,
    20: b20,
    21: b21,
    22: b22,
    23: b23,
    24: b24,
    25: b25,
    26: b26,
    27: b27,
    28: b28,
    29: b29,
    30: b30,
    31: b31,
    32: b32,
    33: b33,
    34: b34,
    35: b35,
    36: b36,
    37: b37,
    38: b38,
    39: b39,
}

n = A0.shape[1]
# For rounding step: 
N = 8
M = 16

# If file is run directly, visualize the GCS
if __name__ == "__main__":
   visualize_results(As, bs, {**{i: 0 for i in range(len(As)-2)}, **{"s": np.hstack([s,s]), "t": np.hstack([t,t])}}, {**{i: 0 for i in range(len(As)-2)}, **{"s": 1, "t": 1}})