import numpy as np
import os
import sys

path_to_utils = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(path_to_utils)
from utils import convert_pt_to_polytope, visualize_results

s = np.array([-34, 9])

t = np.array([10.691075180797185, -18.973671138638046])

A_s, b_s = convert_pt_to_polytope(s, eps=1e-6)
A_t, b_t = convert_pt_to_polytope(t, eps=1e-6)

A0 = np.array([[-0.4472135954999572, -0.8944271909999163], [-0.948683298050514, 0.316227766016838], [-0.2425356250363355, 0.9701425001453313], [0.9363291775690443, 0.35112344158839237], [0.6000000000000004, -0.7999999999999996], [0.3162277660168363, -0.9486832980505143], [0.31622776601684127, 0.9486832980505128], [0.7071067811865468, 0.7071067811865483]])

b0 = np.array([-24.032084121815856, 7.155052483613371, 35.963868439731016, 25.583539649740143, -13.010101010100929, -19.420856741236065, 39.863863837274174, 34.85536456757939])

A1 = np.array([[0.24253562503633144, 0.9701425001453322], [-0.997458699830735, 0.07124704998790977], [-0.9486832980505135, 0.3162277660168388], [-0.31622776601683766, 0.9486832980505139], [-0.7682212795973765, 0.6401843996644792], [0.9191450300180571, 0.39391929857916946], [0.0, -1.0], [-0.17888543819998268, -0.9838699100999075], [0.9965457582448795, -0.0830454798537408], [0.8682431421244595, -0.49613893835683304], [0.27472112789737724, -0.9615239476408234], [0.7071067811865476, 0.7071067811865476], [0.7808688094430312, 0.6246950475544233], [-0.9486832980505135, -0.3162277660168388], [-0.8574929257125444, -0.514495755427526], [-0.4961389383568339, -0.8682431421244592], [-0.7071067811865476, -0.7071067811865476], [0.7071067811865455, -0.7071067811865496], [0.6000000000000018, -0.7999999999999988]])

b1 = np.array([34.59194975265682, -0.08636006059133543, 3.8330638305072084, 21.97623262824093, 11.018931485134125, 41.27531505651083, 8.484848484848552, 4.806416824363263, 37.94926776346668, 31.522362851156494, 14.707292705617258, 39.99795933984518, 40.57362783611066, -1.7887631209032593, -2.078770729000039, 0.5512654870632187, -1.1427988382812195, 26.284373280469648, 23.191919191919308])

A2 = np.array([[-0.6000000000000001, -0.7999999999999999], [1.0, 0.0], [0.7592566023652969, -0.6507913734559682], [-0.98058067569092, 0.19611613513818435], [-0.7071067811865468, 0.7071067811865483], [0.7071067811865483, 0.7071067811865468], [0.14142135623730856, 0.9899494936611668]])

b2 = np.array([3.151515151515184, -5.252525252525224, -10.035772695044873, 17.907978400496837, 19.998979669922583, 3.4283965148438797, 11.999387801953576])

A3 = np.array([[0.9486832980505138, -0.31622776601683794], [-0.37139067635410355, -0.9284766908852593], [0.0, -1.0], [-0.44721359549995643, 0.8944271909999167], [0.4472135954999579, 0.8944271909999159], [0.0, 1.0], [-1.0, 0.0], [-0.8944271909999163, 0.4472135954999572]])

b3 = np.array([-4.599676596608524, 18.982190124765328, 15.757575757575784, -2.3490007036361455, -13.551927136362336, -9.292929292929268, 15.757575757575784, 8.85392572909012])

A4 = np.array([[-0.4788521306805731, 0.8778955729143846], [0.3713906763541029, 0.9284766908852597], [-0.8944271909999163, -0.4472135954999572], [0.6401843996644798, -0.768221279597376], [-1.0, 0.0], [-0.9805806756909204, 0.1961161351381827], [0.8944271909999163, 0.4472135954999572], [0.8000000000000005, 0.5999999999999993], [-0.242535625036333, -0.970142500145332], [-0.4472135954999579, -0.8944271909999159], [0.9701425001453322, -0.24253562503633144], [0.8944271909999155, -0.44721359549995876]])

b4 = np.array([-11.318323088813512, -0.9753694530511569, 4.878693769090476, 26.745481585982755, -2.828282828282791, -5.705196658565298, 12.106388241817097, 8.6464646464647, 18.91287904323732, 15.720235478180378, 23.420611872195405, 25.47762301636129])

A5 = np.array([[-0.8944271909999174, -0.44721359549995476], [-0.514495755427526, 0.8574929257125444], [0.8944271909999174, 0.44721359549995476], [0.7071067811865475, -0.7071067811865475], [0.4472135954999579, -0.8944271909999159]])

b5 = np.array([-44.99239809272292, 11.502531367134017, 49.69039949999534, 2.8569970957032904, -13.190542412725966])

A6 = np.array([[-1.0, -0.0], [0.9805806756909202, -0.19611613513818396], [0.5144957554275262, -0.8574929257125443], [-0.8320502943378437, 0.5547001962252291], [-0.3713906763541031, 0.9284766908852594], [0.24253562503633336, 0.9701425001453319], [0.0, -1.0], [0.8944271909999159, 0.4472135954999579], [0.8320502943378435, 0.5547001962252294], [-0.7071067811865459, -0.707106781186549], [-0.6246950475544247, -0.7808688094430299]])

b6 = np.array([40.00000000000007, -22.18687589442075, -19.263275422067583, 45.608682800741136, 37.13906763541043, 19.696832578708307, -5.252525252525184, -8.853925729090008, -5.266850347997047, 21.141778508203835, 17.352640209845205])

A7 = np.array([[-0.9486832980505138, 0.31622776601683794], [-0.8682431421244593, -0.49613893835683376], [-0.31622776601683833, -0.9486832980505137], [1.0, 0.0], [0.7808688094430304, 0.6246950475544241], [0.14142135623730986, -0.9899494936611665], [0.7071067811865474, -0.7071067811865478], [-0.09950371902099908, 0.995037190209989], [-0.0, 1.0]])

b7 = np.array([-2.81091347570519, 3.45793805521433, 11.499191491521408, 18.98989898989902, 14.071413697438075, 15.999183735938082, 19.998979669922587, 1.6483444363074893, 2.828282828282863])

A8 = np.array([[-0.44721359549995743, -0.8944271909999162], [-1.0, 0.0], [-0.9938837346736189, 0.11043152607484676], [-0.44721359549995476, 0.8944271909999174], [-0.707106781186549, 0.7071067811865459], [0.9761870601839528, 0.21693045781865614], [0.8320502943378435, 0.5547001962252294], [0.19611613513818368, 0.9805806756909202], [0.5547001962252297, 0.8320502943378434], [0.31622776601683833, -0.9486832980505137], [-0.16439898730535776, -0.9863939238321436], [0.9486832980505139, -0.3162277660168375], [0.8574929257125441, -0.5144957554275266], [0.554700196225228, -0.8320502943378445], [0.707106781186549, -0.7071067811865459]])

b8 = np.array([19.695467438180014, 40.00000000000007, 39.79996818535891, 31.259778594542492, 37.712361663282636, -19.940072385351158, -12.662852964333439, 10.142571837449596, -1.9050309769350828, -4.599676596608497, 10.162846487967625, -21.720695039540313, -20.09478371366763, -11.76636779871688, -15.999183735938015])

A9 = np.array([[0.47058823529411764, 0.8823529411764706], [-1.0, -0.0], [-0.8000000000000002, -0.5999999999999996], [0.9138115486202572, -0.40613846605344756], [-0.8944271909999155, 0.44721359549995876], [-0.6507913734559686, 0.7592566023652965], [-0.09053574604251874, 0.9958932064677037], [-0.3162277660168378, 0.948683298050514], [-0.0, -1.0], [0.0475651494154495, -0.9988681377244375], [1.0, -0.0], [0.9899494936611665, 0.14142135623730975], [0.8137334712067352, 0.581238193719096], [0.8944271909999155, 0.44721359549995876]])

b9 = np.array([-16.80332739156262, 40.00000000000007, 54.060606060606126, 11.117527707119693, 28.00731608181559, 13.541719488073761, -6.657578092823511, 0.255537588700535, 40.00000000000007, 38.897722188634255, -2.0202020202019524, -5.942553959062641, -14.93606025072095, -12.467772965453323])

A10 = np.array([[-1.0, -0.0], [0.7071067811865476, -0.7071067811865476], [0.0, 1.0], [0.7071067811865444, 0.7071067811865506]])

b10 = np.array([-35.959595959595894, 5.1425947722658645, 32.72727272727278, 49.14035004609546])

A11 = np.array([[-0.8944271909999153, 0.447213595499959], [0.913811548620257, 0.40613846605344783], [0.7071067811865483, 0.7071067811865468], [-0.9863939238321437, -0.1643989873053573], [-0.17888543819998193, -0.9838699100999078], [-0.0, -1.0], [-0.0, 1.0], [-0.5547001962252303, 0.8320502943378429], [0.8320502943378445, -0.554700196225228], [0.707106781186546, -0.7071067811865491]])

b11 = np.array([20.056852161816387, 19.40439337810923, 29.141370376172905, 1.6605958313673088, -24.754853569088528, -24.64646464646459, 39.191919191919254, 32.38552660789725, -8.852791010463157, -13.713586059375459])

A12 = np.array([[0.7071067811865476, -0.7071067811865476], [0.0766964988847365, 0.9970544855015816], [1.0, -0.0], [-1.0, -0.0], [-0.5547001962252297, -0.8320502943378434], [0.0, -1.0], [-0.2425356250363335, -0.9701425001453319]])

b12 = np.array([-14.28498547851608, 15.928080980507046, -7.676767676767644, 18.181818181818215, -1.0085458113185544, -10.909090909090875, -7.545552778908097])

A13 = np.array([[-1.0, -0.0], [-0.4190581774617466, 0.9079593845004519], [-0.2425356250363335, -0.9701425001453319], [-0.7926239891046001, -0.6097107608496922], [0.997458699830735, -0.07124704998790977], [0.7808688094430299, -0.6246950475544247], [-0.0, -1.0], [0.22485950669875887, -0.9743911956946198], [-0.8944271909999159, 0.4472135954999579], [-0.7808688094430304, 0.6246950475544241], [0.98058067569092, 0.19611613513818435], [0.8, 0.6], [0.31622776601683583, 0.9486832980505144], [0.5144957554275267, 0.857492925712544]])

b13 = np.array([14.141414141414199, 29.207085095818783, -2.8418315660822238, 2.0939561483727402, 11.773754927295023, 3.4705280419690725, -3.636363636363577, -3.8157976894334174, 21.863775779997997, 24.67229935290711, 17.274067660656275, 25.29292929292935, 31.431123410158502, 29.79571378233492])

A14 = np.array([[-0.8944271909999155, 0.44721359549995876], [-0.8000000000000002, 0.5999999999999996], [1.0, -0.0], [-0.8574929257125438, -0.5144957554275271], [0.9191450300180577, -0.39391929857916835], [0.37139067635410355, -0.9284766908852593], [0.2747211278973781, 0.9615239476408233], [0.4961389383568335, 0.8682431421244594], [-0.4472135954999579, -0.8944271909999159], [-0.6246950475544247, -0.7808688094430299]])

b14 = np.array([-10.299464623635357, -12.68686868686863, 16.56565656565662, 11.086777221333973, 24.61664034218644, 32.63736246748189, -12.154328688793038, -8.268982305947187, 23.309314674543316, 18.74085142663277])

A15 = np.array([[0.7071067811865476, -0.7071067811865476], [0.1961161351381827, 0.9805806756909204], [0.8574929257125441, 0.5144957554275266], [-1.0, -0.0], [-0.7071067811865483, -0.7071067811865468], [-0.8320502943378435, -0.5547001962252294]])

b15 = np.array([3.114043484484642e-14, -10.301049522409615, -16.075826970934127, 18.181818181818215, 21.14177850820388, 21.1794620376906])

A16 = np.array([[1.0, -0.0], [-0.3162277660168378, -0.9486832980505139], [0.8000000000000002, -0.5999999999999996], [-0.9938837346736189, 0.11043152607484676], [-0.8944271909999159, 0.4472135954999579], [-0.39391929857916713, 0.9191450300180581], [-0.8000000000000002, 0.5999999999999996], [0.8574929257125444, 0.514495755427526], [-0.8944271909999155, -0.44721359549995876], [-0.7592566023652967, -0.6507913734559683], [0.27472112789737846, -0.961523947640823], [0.44721359549995715, -0.8944271909999163], [0.19611613513818435, 0.98058067569092], [0.4472135954999579, 0.8944271909999159]])

b16 = np.array([40.00000000000007, 17.37655603163238, 44.84848484848492, -16.687430606865636, -18.24992854363458, -9.549558753434287, -17.85858585858579, 30.765806789201662, -5.96284793999935, 0.30677034439008033, 34.687011098153874, 38.84885779090549, 6.4975850833661735, 14.27469658363509])

A17 = np.array([[-0.8320502943378438, 0.5547001962252288], [-0.21693045781865566, 0.9761870601839528], [0.8574929257125441, 0.5144957554275266], [-0.9284766908852591, -0.3713906763541043], [-0.4472135954999579, -0.8944271909999159], [1.0, 0.0], [0.919145030018058, -0.39391929857916763], [0.514495755427526, -0.8574929257125444], [0.3162277660168388, 0.9486832980505135], [0.6507913734559682, 0.759256602365297], [-1.0, -0.0], [-0.9863939238321439, -0.16439898730535682], [0.3162277660168388, -0.9486832980505135], [0.0, -1.0]])

b17 = np.array([30.592556276664208, 19.063585687094072, -5.959142756466919, 27.68548678276051, 15.358850754544063, -10.101010101010047, -10.398408420406259, -4.0189567427334785, 7.666127661014283, -1.0956083728214328, 31.111111111111164, 29.691453464846408, -0.2555375887004372, 6.060606060606116])

A18 = np.array([[-0.8320502943378434, -0.5547001962252295], [-0.9838699100999073, 0.1788854381999835], [-0.7071067811865475, 0.7071067811865475], [-0.06237828615518064, 0.9980525784828885], [0.0, -1.0], [-0.4472135954999579, -0.8944271909999159], [0.9863939238321436, -0.16439898730535765], [0.8944271909999171, -0.4472135954999556], [0.6401843996644803, -0.7682212795973754], [0.6000000000000011, 0.7999999999999992], [0.3162277660168363, -0.9486832980505143], [0.4472135954999579, -0.8944271909999159], [0.9486832980505144, 0.31622776601683583], [0.8320502943378432, 0.5547001962252299]])

b18 = np.array([9.076912301867466, -12.54004991018058, -19.998979669922488, -13.483791148695525, 38.383838383838444, 25.839007739997637, 38.99079012050299, 44.63101336908674, 46.61059750284421, 7.838383838383949, 44.208002845182236, 45.71516753999577, 27.34252199095097, 18.714127832245143])

A19 = np.array([[0.08304547985374015, -0.9965457582448797], [-1.0, 0.0], [0.7525766947068779, -0.6585046078685179], [0.7071067811865459, -0.707106781186549], [-0.9486832980505137, 0.31622776601683833], [-0.9191450300180579, 0.3939192985791675], [0.8944271909999159, 0.4472135954999579], [0.27472112789737757, 0.9615239476408233], [0.7071067811865475, 0.7071067811865475], [1.0, -0.0], [0.9899494936611665, 0.14142135623730986]])

b19 = np.array([16.407773595345052, 40.00000000000007, -10.224400549300448, -7.999591867968879, 37.052950361568946, 36.07611084630768, -22.947929950906865, -2.4974647990669894, -17.141982574219263, -23.83838383838377, -24.684454906875775])

As = {
    "s": A_s,
    "t": A_t,
    0: A0,
    1: A1,
    2: A2,
    3: A3,
    4: A4,
    5: A5,
    6: A6,
    7: A7,
    8: A8,
    9: A9,
    10: A10,
    11: A11,
    12: A12,
    13: A13,
    14: A14,
    15: A15,
    16: A16,
    17: A17,
    18: A18,
    19: A19,
}

bs = {
    "s": b_s,
    "t": b_t,
    0: b0,
    1: b1,
    2: b2,
    3: b3,
    4: b4,
    5: b5,
    6: b6,
    7: b7,
    8: b8,
    9: b9,
    10: b10,
    11: b11,
    12: b12,
    13: b13,
    14: b14,
    15: b15,
    16: b16,
    17: b17,
    18: b18,
    19: b19,
}

n = A0.shape[1]
# For rounding step: 
N = 4
M = 8

# If file is run directly, visualize the GCS
if __name__ == "__main__":
   visualize_results(As, bs, {**{i: 0 for i in range(len(As)-2)}, **{"s": np.hstack([s,s]), "t": np.hstack([t,t])}}, {**{i: 0 for i in range(len(As)-2)}, **{"s": 1, "t": 1}})