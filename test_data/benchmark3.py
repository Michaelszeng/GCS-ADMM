import numpy as np
import os
import sys

path_to_utils = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(path_to_utils)
from utils import convert_pt_to_polytope, visualize_results

s = np.array([6.297982834400823, 8.810098310487426])

t = np.array([1.4520021187571928, -6.593039453142748])

A_s, b_s = convert_pt_to_polytope(s, eps=1e-6)
A_t, b_t = convert_pt_to_polytope(t, eps=1e-6)

A0 = np.array([[0.2095290887308736, -0.9778024140774095], [0.894427190999916, 0.44721359549995787], [-0.9805806756909202, -0.19611613513818352], [-0.9191450300180578, -0.3939192985791678], [-0.7071067811865475, -0.7071067811865475], [0.8320502943378434, -0.5547001962252295], [-0.9863939238321439, 0.16439898730535707], [-0.2425356250363335, 0.9701425001453319], [0.0, 1.0], [0.3417430630867043, 0.9397934234884371], [-0.4472135954999572, -0.8944271909999163], [-0.5144957554275268, -0.857492925712544], [0.9805806756909204, -0.1961161351381827], [0.9284766908852591, -0.3713906763541043], [-0.8000000000000002, 0.5999999999999996], [-0.8574929257125441, 0.5144957554275266], [-0.7071067811865483, 0.7071067811865468], [-0.554700196225228, 0.8320502943378445]])

b0 = np.array([24.127592035676386, -1.2648465327271061, 30.427715512348595, 31.831862511447945, 33.14116631015742, 11.094003924504639, 26.370261802111912, 8.133517930511424, 4.444444444444492, 0.4487535171846096, 31.621163318178894, 31.735899796068352, 5.5467189736052385, 7.877984043874986, 18.66666666666672, 20.371953144201097, 16.570583155078758, 13.559338129950074])

A1 = np.array([[-0.44721359549995754, 0.8944271909999161], [0.9615239476408234, 0.2747211278973774], [-0.9899494936611665, -0.14142135623730967], [1.0, 0.0], [0.37139067635410355, -0.9284766908852593], [-0.98058067569092, 0.19611613513818452], [-0.759256602365297, 0.6507913734559682], [0.14142135623730986, 0.9899494936611665], [0.573462344363328, 0.8192319205190406], [-0.3713906763541029, -0.9284766908852597], [0.0, -1.0], [-0.05872202195147047, -0.998274373174996]])

b1 = np.array([-18.249928543634585, 8.93537405888451, 13.713586059375542, 18.181818181818247, 40.89048860868421, 2.8525983292827295, -11.701097421733492, -18.399061296328682, -11.353395908607245, 38.03940866899616, 40.00000000000007, 39.38527532906705])

A2 = np.array([[-0.8192319205190406, 0.573462344363328], [-1.0, -0.0], [-0.7071067811865476, 0.7071067811865476], [0.9970544855015816, 0.07669649888473652], [0.9701425001453313, 0.24253562503633497], [0.5368754921931588, 0.8436614877321079], [-0.4961389383568339, -0.8682431421244592], [-0.8320502943378438, -0.5547001962252288], [1.0, 0.0], [0.8574929257125444, -0.514495755427526], [-0.3162277660168363, 0.9486832980505143], [0.0, 1.0], [-0.0, -1.0], [0.11043152607484676, -0.9938837346736189], [0.3162277660168363, -0.9486832980505143], [0.2425356250363335, -0.9701425001453319]])

b2 = np.array([13.538014363324796, 0.40404040404046015, 18.284781412500685, 28.943244427613948, 32.436077530111696, 38.30176671577177, -10.173353988528955, -7.956305844846659, 27.878787878787936, 16.63016583200093, 29.386822700554728, 34.343434343434396, -6.868686868686806, -5.80044379383026, -1.5332255322028352, -3.4297967176854467])

A3 = np.array([[-0.3511234415883915, 0.9363291775690447], [-0.4472135954999583, -0.8944271909999156], [0.8944271909999155, -0.44721359549995876], [-0.8682431421244586, 0.49613893835683476], [0.9863939238321435, 0.16439898730535893], [0.8944271909999155, 0.44721359549995876], [0.44721359549995743, 0.8944271909999162], [0.7071067811865491, 0.707106781186546], [-0.8320502943378429, -0.5547001962252303], [-1.0, 0.0], [-0.0, -1.0], [0.37139067635410355, -0.9284766908852593], [0.31622776601683794, -0.9486832980505139]])

b3 = np.array([-0.5201828764271982, 1.6262312563635233, 28.0073160818156, -9.37151328007347, 27.433043134186935, 24.75485356908862, 14.997466030907717, 20.570379089063287, -5.490971639401193, -10.101010101010049, 10.909090909090958, 17.93179225224869, 16.865480854231407])

A4 = np.array([[0.9863939238321437, 0.1643989873053575], [0.3713906763541031, 0.9284766908852594], [-0.8479983040050881, -0.5299989400031798], [-0.8320502943378437, -0.5547001962252291], [-1.0, 0.0], [-0.813733471206735, 0.5812381937190964], [-0.1961161351381827, 0.9805806756909204], [-0.5547001962252291, 0.8320502943378437], [0.9486832980505135, -0.3162277660168388], [0.5547001962252303, -0.8320502943378429], [-0.0, -1.0], [0.14142135623730986, -0.9899494936611665]])

b4 = np.array([12.022713819098911, 27.98560046062241, -0.8137357462674528, -1.2326671027226788, 10.90909090909096, 21.79349671803324, 29.793804772508008, 27.006615614198076, 3.321988653106212, -6.163335513613589, -10.101010101010047, -10.056629776875289])

A5 = np.array([[-0.28734788556634516, 0.9578262852211515], [0.9899494936611665, 0.14142135623730986], [-0.9838699100999075, -0.17888543819998315], [0.9397934234884371, -0.3417430630867043], [-0.8944271909999159, 0.44721359549995826], [-0.8479983040050884, 0.5299989400031793], [0.44721359549995743, 0.8944271909999162], [-0.263117405792109, -0.9647638212377321], [-0.7071067811865475, -0.7071067811865475], [0.3162277660168381, -0.9486832980505138], [0.37139067635410355, -0.9284766908852593], [0.7071067811865481, 0.7071067811865469], [0.6246950475544245, 0.78086880944303]])

b5 = np.array([-6.308108464284696, 15.08494466531306, 13.33509630218062, 24.129131424000697, 0.5420770854545452, -0.9850485349553372, -2.71038542727242, 31.396905256809266, 25.712973861329054, 32.96434894236135, 32.937476145343794, 1.7141982574220058, -0.18930152956188215])

A6 = np.array([[0.9284766908852593, -0.3713906763541039], [-0.14142135623730986, 0.9899494936611665], [0.0, 1.0], [-0.06651901052377408, -0.9977851578566089], [-0.8944271909999152, 0.44721359549995954], [0.9486832980505147, 0.31622776601683544], [0.8137334712067348, 0.5812381937190967], [-0.24253562503633144, -0.9701425001453322], [-0.9965457582448797, 0.08304547985373979], [-1.0, -0.0]])

b6 = np.array([-5.9272451377725295, 16.91342280656312, 14.949494949494985, 1.6663348090804355, 24.754853569088624, -1.2776879435023625, 1.784812231218279, 4.997703788627473, 22.380337398967537, 22.22222222222226])

A7 = np.array([[-0.4280863447390446, 0.9037378388935388], [0.34174306308670416, 0.9397934234884371], [0.0, -1.0], [-0.9701425001453324, 0.24253562503633122], [-0.8320502943378436, 0.554700196225229], [-1.0, -0.0], [0.9805806756909198, 0.19611613513818602], [1.0, 0.0], [0.7071067811865481, 0.707106781186547], [0.7808688094430309, 0.6246950475544236], [-0.44721359549995954, -0.8944271909999152], [-0.5547001962252286, -0.832050294337844]])

b7 = np.array([-26.67492015702772, -10.252291892601066, 40.00000000000007, -11.0733436885274, -20.282976872073963, -2.828282828282762, 30.427715512348545, 37.57575757575765, 6.28539361054719, 10.79018718503107, 32.70531748908787, 29.696071111047708])

A8 = np.array([[-0.9970544855015816, -0.0766964988847372], [-0.98058067569092, 0.19611613513818435], [-0.5812381937190964, -0.813733471206735], [0.8944271909999159, -0.4472135954999579], [0.7071067811865476, -0.7071067811865476], [-0.0, -1.0], [0.3713906763541039, -0.9284766908852593], [-0.287347885566346, 0.9578262852211511], [-0.44721359549995765, 0.894427190999916], [1.0, -0.0], [0.970142500145332, 0.242535625036333], [0.2747211278973785, 0.9615239476408229], [0.7071067811865475, 0.7071067811865475], [-0.2425356250363335, -0.9701425001453319], [-0.3162277660168371, -0.9486832980505141]])

b8 = np.array([36.38048068310361, 36.76682291075456, 26.490371010712817, -10.299464623635334, -6.285393610547029, 12.525252525252586, 2.7760515202226497, 18.614724977429315, 22.94792995090698, -12.525252525252466, -11.857297223998442, 5.716419428975793, -4.571195353125097, 18.12892550776638, 19.931931918637098])

A9 = np.array([[-0.9761870601839528, 0.21693045781865625], [-0.5913636636275174, 0.8064049958557055], [0.9761870601839528, 0.21693045781865575], [0.5299989400031794, 0.8479983040050884], [-0.44721359549995876, -0.8944271909999155], [-0.0, -1.0], [0.7808688094430304, 0.6246950475544241], [0.8000000000000002, 0.5999999999999996], [0.0, 1.0], [0.16439898730535776, 0.9863939238321436], [-0.9486832980505139, -0.31622776601683794], [-0.8944271909999157, -0.44721359549995787], [0.44721359549995954, -0.8944271909999152], [0.2425356250363335, -0.9701425001453319]])

b9 = np.array([24.322505876637276, -4.0836131776665345, -1.621500391775731, -20.429050051031606, 48.96763005272275, 40.00000000000007, -15.207222874809645, -14.464646464646382, -18.989898989898922, -20.65781214220847, 42.16370213557846, 45.353782816359434, 37.40331889636017, 39.29567096548271])

A10 = np.array([[-0.16439898730535765, -0.9863939238321436], [0.8320502943378437, -0.5547001962252291], [0.7999999999999998, -0.6000000000000003], [-0.12403473458920873, 0.9922778767136676], [0.3162277660168375, 0.9486832980505139], [-1.0, -0.0], [-0.8320502943378437, 0.5547001962252291], [-0.7682212795973754, 0.6401843996644803], [0.9701425001453313, 0.2425356250363355], [0.8574929257125444, 0.514495755427526], [-0.7071067811865476, -0.7071067811865476], [-0.8944271909999155, -0.44721359549995876]])

b10 = np.array([-0.5978144992921666, 19.162370415053417, 18.181818181818226, 12.478646025338588, 20.18746950733757, -6.868686868686819, -1.9050309769350828, -0.5690527997017047, 27.7323563172858, 27.301188907534783, -6.856793029687687, -8.131156281817368])

A11 = np.array([[-0.9333456062030596, 0.3589790793088692], [-0.19611613513818468, -0.98058067569092], [0.12403473458920873, -0.9922778767136676], [-0.2747211278973787, 0.9615239476408229], [-0.4472135954999579, 0.8944271909999159], [0.16439898730535776, 0.9863939238321436], [0.7071067811865471, 0.7071067811865479], [-0.98058067569092, -0.19611613513818468], [-0.7592566023652967, -0.6507913734559684], [0.5547001962252288, -0.8320502943378438], [0.8320502943378437, -0.5547001962252291], [1.0, -0.0]])

b11 = np.array([8.122354925776467, 2.852598329282712, 4.059318586555952, 17.59325202898363, 16.44300492545303, 20.39211680918981, 20.570379089063238, 4.595852863844343, 2.147392410730165, 7.956305844846751, 12.214610381525283, 16.565656565656603])

A12 = np.array([[-0.19611613513818385, -0.9805806756909202], [1.0, 0.0], [-0.9938837346736189, 0.11043152607484676], [-0.9701425001453319, -0.24253562503633336], [-1.0, 0.0], [0.8320502943378434, -0.5547001962252295], [0.9486832980505139, 0.31622776601683794], [0.7071067811865472, 0.7071067811865478], [0.11043152607484676, 0.9938837346736189], [0.3162277660168388, 0.9486832980505135], [0.44721359549995754, -0.8944271909999161], [0.6246950475544245, -0.7808688094430303]])

b12 = np.array([22.186875894420883, -23.83838383838377, 39.978443379015225, 40.86357803642466, 40.00000000000007, -16.472914918203696, -22.487307805641745, -15.427784316797325, 4.908067825548796, -2.0443007096037618, -1.2648465327270697, -8.392367810579579])

A13 = np.array([[-0.988371697650617, 0.15205718425394144], [-0.8944271909999157, -0.4472135954999581], [-0.12403473458920873, 0.9922778767136676], [-0.5812381937190967, 0.8137334712067348], [1.0, -0.0], [0.8682431421244586, 0.49613893835683476], [0.44721359549995754, 0.8944271909999161], [0.7071067811865506, 0.7071067811865444], [0.0, -1.0], [-0.2631174057921088, -0.9647638212377322], [0.9701425001453319, -0.2425356250363335], [0.8574929257125443, -0.5144957554275265], [0.44721359549995643, -0.8944271909999167], [0.5547001962252303, -0.8320502943378429]])

b13 = np.array([-9.430617286052456, 1.6262312563635444, -4.560469029340546, -10.520998415602179, 31.111111111111168, 21.198663729792017, 7.4083868345448, 15.427784316797554, 27.878787878787932, 21.687252841046593, 33.80799621718587, 36.30919539986859, 35.23501055454218, 36.195588561767536])

A14 = np.array([[-0.0, -1.0], [0.44721359549995826, 0.8944271909999159], [-1.0, -0.0], [-0.19611613513818435, 0.98058067569092], [-0.4472135954999579, 0.8944271909999159], [0.8574929257125442, 0.5144957554275265], [0.98058067569092, -0.19611613513818452], [1.0, -0.0], [0.5547001962252297, -0.8320502943378434], [0.8000000000000002, -0.5999999999999996], [-0.8944271909999155, 0.44721359549995876], [-0.7071067811865491, 0.707106781186546]])

b14 = np.array([40.00000000000007, -26.200392463633843, 40.00000000000007, -6.814540453286313, 3.4331548745452, -28.409866629668063, -10.934960262250174, -17.373737373737306, 20.507098163478208, 6.545454545454594, 27.284546634542927, 15.999183735938198])

A15 = np.array([[-0.9805806756909202, -0.19611613513818368], [-0.3589790793088692, -0.9333456062030596], [0.5734623443633282, -0.8192319205190405], [-0.7893522173763264, 0.6139406135149202], [-0.2425356250363335, 0.9701425001453319], [0.09053574604251867, 0.9958932064677037], [0.9805806756909203, -0.19611613513818305], [0.9486832980505137, -0.31622776601683833], [0.9701425001453324, 0.24253562503633097], [0.7808688094430299, 0.6246950475544247]])

b15 = np.array([1.9017322195218183, 10.79112868710301, 19.165061898203042, -1.275720755355646, 2.4498547983468275, 5.121213917556638, 20.919054414739662, 21.20961986213947, 19.10886742710507, 15.207222874809752])

A16 = np.array([[0.14142135623730975, 0.9899494936611665], [0.9701425001453319, -0.2425356250363335], [-0.98058067569092, -0.19611613513818435], [0.0, -1.0]])

b16 = np.array([18.17050152867252, -20.28479773031146, 16.79863460577579, -17.373737373737335])

A17 = np.array([[0.9863939238321439, -0.16439898730535682], [-0.7071067811865468, 0.7071067811865483], [0.4472135954999572, 0.8944271909999163], [-0.9284766908852593, -0.37139067635410355], [-0.31622776601683833, -0.9486832980505137]])

b17 = np.array([-21.056355141736628, 29.71276979531355, 8.853925729090134, 14.330428117905862, -7.4105900723137275])

A18 = np.array([[0.9103664774626046, 0.4138029443011842], [0.6643638388299202, 0.7474093186836592], [-0.832050294337844, 0.5547001962252286], [-0.0, 1.0], [-0.8574929257125444, -0.514495755427526], [-0.6246950475544241, -0.7808688094430304], [0.9647638212377321, -0.2631174057921085], [0.8944271909999155, -0.44721359549995876], [-0.9922778767136676, 0.12403473458920873], [-1.0, -0.0], [-0.5547001962252291, 0.8320502943378437], [-0.44721359549995876, 0.8944271909999155], [0.0, -1.0], [-0.242535625036333, -0.970142500145332], [0.31622776601683833, -0.9486832980505137], [0.7071067811865475, -0.7071067811865475], [0.5547001962252288, -0.8320502943378438], [0.44721359549995876, -0.8944271909999155], [0.3713906763541031, -0.9284766908852594]])

b18 = np.array([-16.45180190676216, -15.065624425991553, 29.24782852823944, -0.4040404040403328, 46.564464329602465, 45.24306556530534, -6.378603776778331, -0.9034618090907295, 38.13754869591426, 40.00000000000007, 17.817642666628636, 13.913311859998789, 32.7272727272728, 38.31572904614399, 22.742845394342336, 8.570991287109734, 14.455823295566656, 18.249928543634688, 20.782872191936796])

A19 = np.array([[-0.9701425001453321, 0.2425356250363325], [-0.6246950475544243, 0.7808688094430303], [0.9486832980505141, 0.3162277660168371], [0.5038710255240858, 0.8637789008984336], [-0.6689647316224496, -0.7432941462471664], [-0.5547001962252286, -0.832050294337844], [0.2425356250363335, -0.9701425001453319], [0.832050294337844, -0.5547001962252286], [0.707106781186547, -0.7071067811865481]])

b19 = np.array([17.932937123898594, 20.381464682836302, 7.410590072313804, 14.338148085620496, 2.43259902408167, 1.2326671027227627, -3.2338083338177412, -1.9050309769350864, -3.428396514843835])

As = {
    "s": A_s,
    "t": A_t,
    0: A0,
    1: A1,
    2: A2,
    3: A3,
    4: A4,
    5: A5,
    6: A6,
    7: A7,
    8: A8,
    9: A9,
    10: A10,
    11: A11,
    12: A12,
    13: A13,
    14: A14,
    15: A15,
    16: A16,
    17: A17,
    18: A18,
    19: A19,
}

bs = {
    "s": b_s,
    "t": b_t,
    0: b0,
    1: b1,
    2: b2,
    3: b3,
    4: b4,
    5: b5,
    6: b6,
    7: b7,
    8: b8,
    9: b9,
    10: b10,
    11: b11,
    12: b12,
    13: b13,
    14: b14,
    15: b15,
    16: b16,
    17: b17,
    18: b18,
    19: b19,
}

n = A0.shape[1]
# For rounding step: 
N = 4
M = 8

# If file is run directly, visualize the GCS
if __name__ == "__main__":
   visualize_results(As, bs, {**{i: 0 for i in range(len(As)-2)}, **{"s": np.hstack([s,s]), "t": np.hstack([t,t])}}, {**{i: 0 for i in range(len(As)-2)}, **{"s": 1, "t": 1}})